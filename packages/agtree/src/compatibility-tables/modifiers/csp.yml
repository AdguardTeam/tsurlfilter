adg_os_any:
  name: csp
  description: |-
    This modifier completely changes the rule behavior.
    If it is applied to a rule, it will not block the matching request.
    The response headers are going to be modified instead.
  docs: https://adguard.app/kb/general/ad-filtering/create-own-filters/#csp-modifier
  conflicts:
    - domain
    - important
    - subdocument
    - badfilter
  inverse_conflicts: true
  assignable: true
  negatable: false
  value_optional: true
  # TODO: add custom validator instead of regular expression. AG-25274
  value_format: |-
    (?xi)
      ^(
        base-uri|
        child-src|
        connect-src|
        default-src|
        font-src|
        form-action|
        frame-ancestors|
        frame-src|
        img-src|
        manifest-src|
        media-src|
        navigate-to|
        object-src|
        plugin-types|
        prefetch-src|
        report-to|
        report-uri|
        sandbox|
        script-src|
        style-src|
        upgrade-insecure-requests|
        worker-src|
      )
      \s+
      \S{1,}

adg_ext_any:
  name: csp
  description: |-
    This modifier completely changes the rule behavior.
    If it is applied to a rule, it will not block the matching request.
    The response headers are going to be modified instead.
  docs: https://adguard.app/kb/general/ad-filtering/create-own-filters/#csp-modifier
  conflicts:
    - domain
    - important
    - subdocument
    - badfilter
  inverse_conflicts: true
  assignable: true
  negatable: false
  value_optional: true
  value_format: |-
    (?xi)
      ^(
        base-uri|
        child-src|
        connect-src|
        default-src|
        font-src|
        form-action|
        frame-ancestors|
        frame-src|
        img-src|
        manifest-src|
        media-src|
        navigate-to|
        object-src|
        plugin-types|
        prefetch-src|
        report-to|
        report-uri|
        sandbox|
        script-src|
        style-src|
        upgrade-insecure-requests|
        worker-src|
      )
      \s+
      \S{1,}

abp_ext_any:
  name: csp
  description: |-
    This modifier completely changes the rule behavior.
    If it is applied to a rule, it will not block the matching request.
    The response headers are going to be modified instead.
  docs: https://help.adblockplus.org/hc/en-us/articles/360062733293-How-to-write-filters#content-security-policies
  conflicts:
    - domain
    - subdocument
  inverse_conflicts: true
  assignable: true
  negatable: false
  value_optional: true
  value_format: |-
    (?xi)
      ^(
        base-uri|
        child-src|
        connect-src|
        default-src|
        font-src|
        form-action|
        frame-ancestors|
        frame-src|
        img-src|
        manifest-src|
        media-src|
        navigate-to|
        object-src|
        plugin-types|
        prefetch-src|
        report-to|
        report-uri|
        sandbox|
        script-src|
        style-src|
        upgrade-insecure-requests|
        worker-src|
      )
      \s+
      \S{1,}

ubo_ext_any:
  name: csp
  description: |-
    This modifier completely changes the rule behavior.
    If it is applied to a rule, it will not block the matching request.
    The response headers are going to be modified instead.
  docs: https://github.com/gorhill/uBlock/wiki/Static-filter-syntax#csp
  conflicts:
    - 1p
    - 3p
    - domain
    - badfilter
  inverse_conflicts: true
  assignable: true
  negatable: false
  value_optional: true
  value_format: |-
    (?xi)
      ^(
        base-uri|
        child-src|
        connect-src|
        default-src|
        font-src|
        form-action|
        frame-ancestors|
        frame-src|
        img-src|
        manifest-src|
        media-src|
        navigate-to|
        object-src|
        plugin-types|
        prefetch-src|
        report-to|
        report-uri|
        sandbox|
        script-src|
        style-src|
        upgrade-insecure-requests|
        worker-src|
      )
      \s+
      \S{1,}
