var Q=Object.defineProperty;var o=(e,s)=>Q(e,"name",{value:s,configurable:!0});import{r as z}from"./get-pipe-path-BHW2eJdv.mjs";import P from"node:module";import p from"node:path";import{fileURLToPath as O}from"node:url";import{parseTsconfig as B,getTsconfig as G,createFilesMatcher as H,createPathsMatcher as X}from"get-tsconfig";import K from"node:fs";import{b as V,i as Y,a as Z}from"./index-DeKCL_WS.mjs";import{p as U}from"./client-BQVF1NaW.mjs";const q=[".js",".json",".ts",".tsx",".jsx"],j=Object.create(null);j[".js"]=[".ts",".tsx",".js",".jsx"],j[".jsx"]=[".tsx",".ts",".jsx",".js"],j[".cjs"]=[".cts"],j[".mjs"]=[".mts"];const F=o((e,s)=>{const n=e.split("?");let[r]=n;const t=p.extname(r);let a=j[t];if(a)r=r.slice(0,-t.length);else{if(!s)return;a=q}return a.map(c=>r+c+(n[1]?`?${n[1]}`:""))},"mapTsExtensions"),ee=o(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),L=o(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),se=o(e=>L(e)||p.isAbsolute(e),"isUnixPath"),te=o(e=>{if(se(e))return!0;const s=ee(e);return s&&s!=="node"},"requestAcceptsQuery"),_="file://",$=/\.([cm]?ts|[tj]sx)($|\?)/,ne=/[/\\].+\.(?:cts|cjs)(?:$|\?)/,re=/\.json($|\?)/,ae=/\/(?:$|\?)/,W=/^(?:@[^/]+\/)?[^/\\]+$/;let w,y,S=!1;const D=o(e=>{let s=null;if(e){const n=p.resolve(e);s={path:n,config:B(n)}}else{try{s=G()}catch{}if(!s)return}w=H(s),y=X(s),S=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),v=o(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),M=[".ts",".tsx",".jsx"],N=o((e,...s)=>{for(const n of M){const r=s.slice();r[0]+=n;try{return e(...r)}catch{}}},"tryExtensions"),oe=o(e=>(s,...n)=>{try{return e(s,...n)}catch(r){const t=r;if(t.code==="MODULE_NOT_FOUND"&&!W.test(s)){const a=N(e,s,...n)||N(e,`${s}${p.sep}index`,...n);if(a)return a}throw t}},"createImplicitResolver"),ce=`${p.sep}node_modules${p.sep}`,A=o(e=>{if(!e.startsWith("data:text/javascript,"))return;const s=e.indexOf("?");if(s===-1)return;const r=new URLSearchParams(e.slice(s+1)).get("filePath");if(r)return r},"getOriginalFilePath"),C=o(e=>{const s=A(e);return s&&(P._cache[s]=P._cache[e],delete P._cache[e],e=s),e},"interopCjsExports"),b=o((e,s,n)=>{if(!(n?.filename&&$.test(n.filename))&&!S)return;const r=F(s);if(r)for(const t of r)try{return e(t)}catch(a){const{code:c}=a;if(c!=="MODULE_NOT_FOUND"&&c!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw a}},"resolveTsFilename"),ie=o((e,s,n)=>{if(e.startsWith(_)&&(e=O(e)),y&&!L(e)&&!s?.filename?.includes(ce)){const t=y(e);for(const a of t){const c=b(n,a,s);if(c)return c;try{return n(a)}catch{}}}const r=b(n,e,s);if(r)return r;try{return n(e)}catch(t){const a=t;if(a.code==="MODULE_NOT_FOUND"&&typeof a.path=="string"&&a.path.endsWith(`${p.sep}package.json`)){const c=a.message.match(/^Cannot find module '([^']+)'$/);if(c){const u=c[1],m=b(n,u,s);if(m)return m}const i=a.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const u=i[1],m=b(n,u,s);if(m)return m}}throw a}},"resolveRequest"),I="at cjsPreparseModuleExports (node:internal",le=o(e=>{const s=e.stack.split(`
`).slice(1);return s[1].includes(I)||s[2].includes(I)},"fromCjsLexer"),fe=o((e,s,n)=>(r,t,...a)=>{if(e.enabled===!1)return s(r,t,...a);r=C(r);const c=r.split("?"),i=new URLSearchParams(c[1]);if(t?.filename){const d=A(t.filename);let l;if(d){const x=d.split("?"),E=x[0];l=x[1],t.filename=E,t.path=p.dirname(E),t.paths=P._nodeModulePaths(t.path),P._cache[E]=t}l||(l=t.filename.split("?")[1]);const g=new URLSearchParams(l).get("namespace");g&&i.append("namespace",g)}if((i.get("namespace")??void 0)!==n)return s(r,t,...a);let u=s;n&&(u=oe(u));const m=o(d=>u(d,t,...a),"resolve");let h=ie(c[0],t,m);return p.isAbsolute(h)&&!h.endsWith(".json")&&!h.endsWith(".node")&&!(a.length===0&&le(new Error))&&(h+=v(i)),h},"createResolveFilename"),me=`
//# sourceMappingURL=data:application/json;base64,`,k=o(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),R=o(({code:e,map:s})=>e+me+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),he=[".cts",".mts",".ts",".tsx",".jsx"],ue=[".js",".cjs",".mjs"],T=o((e,s,n,r)=>{const t=Object.getOwnPropertyDescriptor(e,s);t?.set?e[s]=n:(!t||t.configurable)&&Object.defineProperty(e,s,{value:n,enumerable:t?.enumerable||r?.enumerable,writable:r?.writable??(t?t.writable:!0),configurable:r?.configurable??(t?t.configurable:!0)})},"safeSet"),pe=o((e,s,n)=>{const r=s[".js"],t=o((a,c)=>{if(e.enabled===!1)return r(a,c);const[i,u]=c.split("?");if((new URLSearchParams(u).get("namespace")??void 0)!==n)return r(a,c);U?.send&&U.send({type:"dependency",path:i});const h=he.some(f=>i.endsWith(f)),d=ue.some(f=>i.endsWith(f));if(!h&&!d)return r(a,i);let l=K.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=V(c,l);f&&(l=k()?R(f):f.code)}else if(h||Y(l)){const f=Z(l,c,{tsconfigRaw:w?.(i)});l=k()?R(f):f.code}a._compile(l,i)},"transformer");T(s,".js",t);for(const a of M)T(s,a,t,{enumerable:!n,writable:!0,configurable:!0});return T(s,".mjs",t,{writable:!0,configurable:!0}),()=>{s[".js"]===t&&(s[".js"]=r);for(const a of[...M,".mjs"])s[a]===t&&delete s[a]}},"createExtensions"),J=o((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return e.startsWith(".")?((typeof s=="string"&&s.startsWith(_)||s instanceof URL)&&(s=O(s)),p.resolve(p.dirname(s),e)):e},"resolveContext"),de=o(e=>{const{sourceMapsEnabled:s}=process,n={enabled:!0};D(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=P._resolveFilename,t=fe(n,r,e?.namespace);P._resolveFilename=t;const a=pe(n,P._extensions,e?.namespace),c=o(()=>{s===!1&&process.setSourceMapsEnabled(!1),n.enabled=!1,P._resolveFilename===t&&(P._resolveFilename=r),a()},"unregister");if(e?.namespace){const i=o((m,h)=>{const d=J(m,h),[l,f]=d.split("?"),g=new URLSearchParams(f);return e.namespace&&!l.startsWith("node:")&&g.set("namespace",e.namespace),z(l+v(g))},"scopedRequire");c.require=i;const u=o((m,h,d)=>{const l=J(m,h),[f,g]=l.split("?"),x=new URLSearchParams(g);return e.namespace&&!f.startsWith("node:")&&x.set("namespace",e.namespace),t(f+v(x),module,!1,d)},"scopedResolve");c.resolve=u,c.unregister=c}return c},"register");export{C as a,re as b,ne as c,R as d,w as e,_ as f,te as g,y as h,W as i,ae as j,S as k,D as l,F as m,de as r,$ as t};
