"use strict";var k=Object.defineProperty;var c=(e,t)=>k(e,"name",{value:t,configurable:!0});var Q=require("./get-pipe-path-BoR10qr8.cjs"),P=require("node:module"),d=require("node:path"),R=require("node:url"),y=require("get-tsconfig"),B=require("node:fs"),v=require("./index-BsW12Ot9.cjs"),U=require("./client-D6NvIMSC.cjs");const z=[".js",".json",".ts",".tsx",".jsx"],j=Object.create(null);j[".js"]=[".ts",".tsx",".js",".jsx"],j[".jsx"]=[".tsx",".ts",".jsx",".js"],j[".cjs"]=[".cts"],j[".mjs"]=[".mts"];const O=c((e,t)=>{const n=e.split("?");let[r]=n;const s=d.extname(r);let a=j[s];if(a)r=r.slice(0,-s.length);else{if(!t)return;a=z}return a.map(o=>r+o+(n[1]?`?${n[1]}`:""))},"mapTsExtensions"),G=c(e=>{const t=e.indexOf(":");if(t!==-1)return e.slice(0,t)},"getScheme"),F=c(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),H=c(e=>F(e)||d.isAbsolute(e),"isUnixPath"),X=c(e=>{if(H(e))return!0;const t=G(e);return t&&t!=="node"},"requestAcceptsQuery"),_="file://",L=/\.([cm]?ts|[tj]sx)($|\?)/,K=/[/\\].+\.(?:cts|cjs)(?:$|\?)/,V=/\.json($|\?)/,Y=/\/(?:$|\?)/,$=/^(?:@[^/]+\/)?[^/\\]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const D=c(e=>{let t=null;if(e){const n=d.resolve(e);t={path:n,config:y.parseTsconfig(n)}}else{try{t=y.getTsconfig()}catch{}if(!t)return}exports.fileMatcher=y.createFilesMatcher(t),exports.tsconfigPathsMatcher=y.createPathsMatcher(t),exports.allowJs=t?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),M=c(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),w=[".ts",".tsx",".jsx"],N=c((e,...t)=>{for(const n of w){const r=t.slice();r[0]+=n;try{return e(...r)}catch{}}},"tryExtensions"),Z=c(e=>(t,...n)=>{try{return e(t,...n)}catch(r){const s=r;if(s.code==="MODULE_NOT_FOUND"&&!$.test(t)){const a=N(e,t,...n)||N(e,`${t}${d.sep}index`,...n);if(a)return a}throw s}},"createImplicitResolver"),q=`${d.sep}node_modules${d.sep}`,W=c(e=>{if(!e.startsWith("data:text/javascript,"))return;const t=e.indexOf("?");if(t===-1)return;const r=new URLSearchParams(e.slice(t+1)).get("filePath");if(r)return r},"getOriginalFilePath"),A=c(e=>{const t=W(e);return t&&(P._cache[t]=P._cache[e],delete P._cache[e],e=t),e},"interopCjsExports"),E=c((e,t,n)=>{if(!(n?.filename&&L.test(n.filename))&&!exports.allowJs)return;const r=O(t);if(r)for(const s of r)try{return e(s)}catch(a){const{code:o}=a;if(o!=="MODULE_NOT_FOUND"&&o!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw a}},"resolveTsFilename"),ee=c((e,t,n)=>{if(e.startsWith(_)&&(e=R.fileURLToPath(e)),exports.tsconfigPathsMatcher&&!F(e)&&!t?.filename?.includes(q)){const s=exports.tsconfigPathsMatcher(e);for(const a of s){const o=E(n,a,t);if(o)return o;try{return n(a)}catch{}}}const r=E(n,e,t);if(r)return r;try{return n(e)}catch(s){const a=s;if(a.code==="MODULE_NOT_FOUND"&&typeof a.path=="string"&&a.path.endsWith(`${d.sep}package.json`)){const o=a.message.match(/^Cannot find module '([^']+)'$/);if(o){const m=o[1],u=E(n,m,t);if(u)return u}const i=a.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const m=i[1],u=E(n,m,t);if(u)return u}}throw a}},"resolveRequest"),C="at cjsPreparseModuleExports (node:internal",te=c(e=>{const t=e.stack.split(`
`).slice(1);return t[1].includes(C)||t[2].includes(C)},"fromCjsLexer"),se=c((e,t,n)=>(r,s,...a)=>{if(e.enabled===!1)return t(r,s,...a);r=A(r);const o=r.split("?"),i=new URLSearchParams(o[1]);if(s?.filename){const p=W(s.filename);let l;if(p){const x=p.split("?"),b=x[0];l=x[1],s.filename=b,s.path=d.dirname(b),s.paths=P._nodeModulePaths(s.path),P._cache[b]=s}l||(l=s.filename.split("?")[1]);const g=new URLSearchParams(l).get("namespace");g&&i.append("namespace",g)}if((i.get("namespace")??void 0)!==n)return t(r,s,...a);let m=t;n&&(m=Z(m));const u=c(p=>m(p,s,...a),"resolve");let h=ee(o[0],s,u);return d.isAbsolute(h)&&!h.endsWith(".json")&&!h.endsWith(".node")&&!(a.length===0&&te(new Error))&&(h+=M(i)),h},"createResolveFilename"),ne=`
//# sourceMappingURL=data:application/json;base64,`,J=c(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),S=c(({code:e,map:t})=>e+ne+Buffer.from(JSON.stringify(t),"utf8").toString("base64"),"inlineSourceMap"),re=[".cts",".mts",".ts",".tsx",".jsx"],ae=[".js",".cjs",".mjs"],T=c((e,t,n,r)=>{const s=Object.getOwnPropertyDescriptor(e,t);s?.set?e[t]=n:(!s||s.configurable)&&Object.defineProperty(e,t,{value:n,enumerable:s?.enumerable||r?.enumerable,writable:r?.writable??(s?s.writable:!0),configurable:r?.configurable??(s?s.configurable:!0)})},"safeSet"),ce=c((e,t,n)=>{const r=t[".js"],s=c((a,o)=>{if(e.enabled===!1)return r(a,o);const[i,m]=o.split("?");if((new URLSearchParams(m).get("namespace")??void 0)!==n)return r(a,o);U.parent?.send&&U.parent.send({type:"dependency",path:i});const h=re.some(f=>i.endsWith(f)),p=ae.some(f=>i.endsWith(f));if(!h&&!p)return r(a,i);let l=B.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=v.transformDynamicImport(o,l);f&&(l=J()?S(f):f.code)}else if(h||v.isESM(l)){const f=v.transformSync(l,o,{tsconfigRaw:exports.fileMatcher?.(i)});l=J()?S(f):f.code}a._compile(l,i)},"transformer");T(t,".js",s);for(const a of w)T(t,a,s,{enumerable:!n,writable:!0,configurable:!0});return T(t,".mjs",s,{writable:!0,configurable:!0}),()=>{t[".js"]===s&&(t[".js"]=r);for(const a of[...w,".mjs"])t[a]===s&&delete t[a]}},"createExtensions"),I=c((e,t)=>{if(!t)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return e.startsWith(".")?((typeof t=="string"&&t.startsWith(_)||t instanceof URL)&&(t=R.fileURLToPath(t)),d.resolve(d.dirname(t),e)):e},"resolveContext"),oe=c(e=>{const{sourceMapsEnabled:t}=process,n={enabled:!0};D(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=P._resolveFilename,s=se(n,r,e?.namespace);P._resolveFilename=s;const a=ce(n,P._extensions,e?.namespace),o=c(()=>{t===!1&&process.setSourceMapsEnabled(!1),n.enabled=!1,P._resolveFilename===s&&(P._resolveFilename=r),a()},"unregister");if(e?.namespace){const i=c((u,h)=>{const p=I(u,h),[l,f]=p.split("?"),g=new URLSearchParams(f);return e.namespace&&!l.startsWith("node:")&&g.set("namespace",e.namespace),Q.require(l+M(g))},"scopedRequire");o.require=i;const m=c((u,h,p)=>{const l=I(u,h),[f,g]=l.split("?"),x=new URLSearchParams(g);return e.namespace&&!f.startsWith("node:")&&x.set("namespace",e.namespace),s(f+M(x),module,!1,p)},"scopedResolve");o.resolve=m,o.unregister=o}return o},"register");exports.cjsExtensionPattern=K,exports.fileUrlPrefix=_,exports.inlineSourceMap=S,exports.interopCjsExports=A,exports.isBarePackageNamePattern=$,exports.isDirectoryPattern=Y,exports.isJsonPattern=V,exports.loadTsconfig=D,exports.mapTsExtensions=O,exports.register=oe,exports.requestAcceptsQuery=X,exports.tsExtensionsPattern=L;
