{"version":3,"file":"matchName.js","names":["iterateJsdoc","context","jsdoc","report","info","lastIndex","utils","match","options","allowName","disallowName","replacement","tags","allowNameRegex","getRegexFromString","disallowNameRegex","applicableTags","includes","getPresentTags","reported","tag","allowed","test","name","disallowed","hasRegex","fixer","src","source","tokens","replace","message","reportJSDoc","undefined","matchContext","meta","docs","description","url","fixable","schema","additionalProperies","properties","items","type","comment","required"],"sources":["../../src/rules/matchName.js"],"sourcesContent":["import iterateJsdoc from '../iterateJsdoc';\n\n// eslint-disable-next-line complexity\nexport default iterateJsdoc(({\n  context,\n  jsdoc,\n  report,\n  info: {\n    lastIndex,\n  },\n  utils,\n}) => {\n  const {\n    match,\n  } = context.options[0] || {};\n  if (!match) {\n    report('Rule `no-restricted-syntax` is missing a `match` option.');\n\n    return;\n  }\n\n  const {\n    allowName,\n    disallowName,\n    replacement,\n    tags = [\n      '*',\n    ],\n  } = match[lastIndex];\n\n  const allowNameRegex = allowName && utils.getRegexFromString(allowName);\n  const disallowNameRegex = disallowName && utils.getRegexFromString(disallowName);\n\n  let applicableTags = jsdoc.tags;\n  if (!tags.includes('*')) {\n    applicableTags = utils.getPresentTags(tags);\n  }\n\n  let reported = false;\n  for (const tag of applicableTags) {\n    const allowed = !allowNameRegex || allowNameRegex.test(tag.name);\n    const disallowed = disallowNameRegex && disallowNameRegex.test(tag.name);\n    const hasRegex = allowNameRegex || disallowNameRegex;\n    if (hasRegex && allowed && !disallowed) {\n      continue;\n    }\n\n    if (!hasRegex && reported) {\n      continue;\n    }\n\n    const fixer = () => {\n      for (const src of tag.source) {\n        if (src.tokens.name) {\n          src.tokens.name = src.tokens.name.replace(\n            disallowNameRegex, replacement,\n          );\n          break;\n        }\n      }\n    };\n\n    let {\n      message,\n    } = match[lastIndex];\n    if (!message) {\n      if (hasRegex) {\n        message = disallowed ?\n          `Only allowing names not matching \\`${disallowNameRegex}\\` but found \"${tag.name}\".` :\n          `Only allowing names matching \\`${allowNameRegex}\\` but found \"${tag.name}\".`;\n      } else {\n        message = `Prohibited context for \"${tag.name}\".`;\n      }\n    }\n\n    utils.reportJSDoc(\n      message,\n      hasRegex ? tag : null,\n\n      // We could match up\n      disallowNameRegex && replacement !== undefined ?\n        fixer :\n        null,\n      false,\n      {\n        // Could also supply `context`, `comment`, `tags`\n        allowName,\n        disallowName,\n        name: tag.name,\n      },\n    );\n    if (!hasRegex) {\n      reported = true;\n    }\n  }\n}, {\n  matchContext: true,\n  meta: {\n    docs: {\n      description: 'Reports the name portion of a JSDoc tag if matching or not matching a given regular expression.',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc#eslint-plugin-jsdoc-rules-match-name',\n    },\n    fixable: 'code',\n    schema: [\n      {\n        additionalProperies: false,\n        properties: {\n          match: {\n            additionalProperies: false,\n            items: {\n              properties: {\n                allowName: {\n                  type: 'string',\n                },\n                comment: {\n                  type: 'string',\n                },\n                context: {\n                  type: 'string',\n                },\n                disallowName: {\n                  type: 'string',\n                },\n                message: {\n                  type: 'string',\n                },\n                tags: {\n                  items: {\n                    type: 'string',\n                  },\n                  type: 'array',\n                },\n              },\n              type: 'object',\n            },\n            type: 'array',\n          },\n        },\n        required: [\n          'match',\n        ],\n        type: 'object',\n      },\n    ],\n    type: 'suggestion',\n  },\n});\n"],"mappings":";;;;;;;AAAA;;;;AAEA;eACe,IAAAA,qBAAA,EAAa,CAAC;EAC3BC,OAD2B;EAE3BC,KAF2B;EAG3BC,MAH2B;EAI3BC,IAAI,EAAE;IACJC;EADI,CAJqB;EAO3BC;AAP2B,CAAD,KAQtB;EACJ,MAAM;IACJC;EADI,IAEFN,OAAO,CAACO,OAAR,CAAgB,CAAhB,KAAsB,EAF1B;;EAGA,IAAI,CAACD,KAAL,EAAY;IACVJ,MAAM,CAAC,0DAAD,CAAN;IAEA;EACD;;EAED,MAAM;IACJM,SADI;IAEJC,YAFI;IAGJC,WAHI;IAIJC,IAAI,GAAG,CACL,GADK;EAJH,IAOFL,KAAK,CAACF,SAAD,CAPT;EASA,MAAMQ,cAAc,GAAGJ,SAAS,IAAIH,KAAK,CAACQ,kBAAN,CAAyBL,SAAzB,CAApC;EACA,MAAMM,iBAAiB,GAAGL,YAAY,IAAIJ,KAAK,CAACQ,kBAAN,CAAyBJ,YAAzB,CAA1C;EAEA,IAAIM,cAAc,GAAGd,KAAK,CAACU,IAA3B;;EACA,IAAI,CAACA,IAAI,CAACK,QAAL,CAAc,GAAd,CAAL,EAAyB;IACvBD,cAAc,GAAGV,KAAK,CAACY,cAAN,CAAqBN,IAArB,CAAjB;EACD;;EAED,IAAIO,QAAQ,GAAG,KAAf;;EACA,KAAK,MAAMC,GAAX,IAAkBJ,cAAlB,EAAkC;IAChC,MAAMK,OAAO,GAAG,CAACR,cAAD,IAAmBA,cAAc,CAACS,IAAf,CAAoBF,GAAG,CAACG,IAAxB,CAAnC;IACA,MAAMC,UAAU,GAAGT,iBAAiB,IAAIA,iBAAiB,CAACO,IAAlB,CAAuBF,GAAG,CAACG,IAA3B,CAAxC;IACA,MAAME,QAAQ,GAAGZ,cAAc,IAAIE,iBAAnC;;IACA,IAAIU,QAAQ,IAAIJ,OAAZ,IAAuB,CAACG,UAA5B,EAAwC;MACtC;IACD;;IAED,IAAI,CAACC,QAAD,IAAaN,QAAjB,EAA2B;MACzB;IACD;;IAED,MAAMO,KAAK,GAAG,MAAM;MAClB,KAAK,MAAMC,GAAX,IAAkBP,GAAG,CAACQ,MAAtB,EAA8B;QAC5B,IAAID,GAAG,CAACE,MAAJ,CAAWN,IAAf,EAAqB;UACnBI,GAAG,CAACE,MAAJ,CAAWN,IAAX,GAAkBI,GAAG,CAACE,MAAJ,CAAWN,IAAX,CAAgBO,OAAhB,CAChBf,iBADgB,EACGJ,WADH,CAAlB;UAGA;QACD;MACF;IACF,CATD;;IAWA,IAAI;MACFoB;IADE,IAEAxB,KAAK,CAACF,SAAD,CAFT;;IAGA,IAAI,CAAC0B,OAAL,EAAc;MACZ,IAAIN,QAAJ,EAAc;QACZM,OAAO,GAAGP,UAAU,GACjB,sCAAqCT,iBAAkB,iBAAgBK,GAAG,CAACG,IAAK,IAD/D,GAEjB,kCAAiCV,cAAe,iBAAgBO,GAAG,CAACG,IAAK,IAF5E;MAGD,CAJD,MAIO;QACLQ,OAAO,GAAI,2BAA0BX,GAAG,CAACG,IAAK,IAA9C;MACD;IACF;;IAEDjB,KAAK,CAAC0B,WAAN,CACED,OADF,EAEEN,QAAQ,GAAGL,GAAH,GAAS,IAFnB,EAIE;IACAL,iBAAiB,IAAIJ,WAAW,KAAKsB,SAArC,GACEP,KADF,GAEE,IAPJ,EAQE,KARF,EASE;MACE;MACAjB,SAFF;MAGEC,YAHF;MAIEa,IAAI,EAAEH,GAAG,CAACG;IAJZ,CATF;;IAgBA,IAAI,CAACE,QAAL,EAAe;MACbN,QAAQ,GAAG,IAAX;IACD;EACF;AACF,CA5Fc,EA4FZ;EACDe,YAAY,EAAE,IADb;EAEDC,IAAI,EAAE;IACJC,IAAI,EAAE;MACJC,WAAW,EAAE,iGADT;MAEJC,GAAG,EAAE;IAFD,CADF;IAKJC,OAAO,EAAE,MALL;IAMJC,MAAM,EAAE,CACN;MACEC,mBAAmB,EAAE,KADvB;MAEEC,UAAU,EAAE;QACVnC,KAAK,EAAE;UACLkC,mBAAmB,EAAE,KADhB;UAELE,KAAK,EAAE;YACLD,UAAU,EAAE;cACVjC,SAAS,EAAE;gBACTmC,IAAI,EAAE;cADG,CADD;cAIVC,OAAO,EAAE;gBACPD,IAAI,EAAE;cADC,CAJC;cAOV3C,OAAO,EAAE;gBACP2C,IAAI,EAAE;cADC,CAPC;cAUVlC,YAAY,EAAE;gBACZkC,IAAI,EAAE;cADM,CAVJ;cAaVb,OAAO,EAAE;gBACPa,IAAI,EAAE;cADC,CAbC;cAgBVhC,IAAI,EAAE;gBACJ+B,KAAK,EAAE;kBACLC,IAAI,EAAE;gBADD,CADH;gBAIJA,IAAI,EAAE;cAJF;YAhBI,CADP;YAwBLA,IAAI,EAAE;UAxBD,CAFF;UA4BLA,IAAI,EAAE;QA5BD;MADG,CAFd;MAkCEE,QAAQ,EAAE,CACR,OADQ,CAlCZ;MAqCEF,IAAI,EAAE;IArCR,CADM,CANJ;IA+CJA,IAAI,EAAE;EA/CF;AAFL,CA5FY,C"}