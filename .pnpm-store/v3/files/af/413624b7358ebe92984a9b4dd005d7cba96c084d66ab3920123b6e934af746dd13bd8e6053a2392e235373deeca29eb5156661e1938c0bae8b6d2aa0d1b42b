{"version":3,"file":"noMissingSyntax.js","names":["setDefaults","state","selectorMap","incrementSelector","selector","comment","iterateJsdoc","context","node","info","sourceCode","options","contexts","foundContext","find","cntxt","esquery","matches","parse","visitorKeys","contextStr","contextSelected","exit","length","report","loc","start","column","line","message","some","contextKey","undefined","minimum","Object","values","every","cmmnt","data","end","matchContext","meta","docs","description","url","fixable","schema","additionalProperties","properties","items","anyOf","type"],"sources":["../../src/rules/noMissingSyntax.js"],"sourcesContent":["import esquery from 'esquery';\nimport iterateJsdoc from '../iterateJsdoc';\n\nconst setDefaults = (state) => {\n  if (!state.selectorMap) {\n    state.selectorMap = {};\n  }\n};\n\nconst incrementSelector = (state, selector, comment) => {\n  if (!state.selectorMap[selector]) {\n    state.selectorMap[selector] = {};\n  }\n\n  if (!state.selectorMap[selector][comment]) {\n    state.selectorMap[selector][comment] = 0;\n  }\n\n  state.selectorMap[selector][comment]++;\n};\n\nexport default iterateJsdoc(({\n  context,\n  node,\n  info: {\n    comment,\n  },\n  sourceCode,\n  state,\n}) => {\n  if (!context.options[0]) {\n    // Handle error later\n    return;\n  }\n\n  const {\n    contexts,\n  } = context.options[0];\n\n  const foundContext = contexts.find((cntxt) => {\n    return typeof cntxt === 'string' ?\n      esquery.matches(node, esquery.parse(cntxt), null, {\n        visitorKeys: sourceCode.visitorKeys,\n      }) :\n      (!cntxt.context || cntxt.context === 'any' || esquery.matches(node, esquery.parse(cntxt.context), null, {\n        visitorKeys: sourceCode.visitorKeys,\n      })) &&\n        comment === cntxt.comment;\n  });\n\n  const contextStr = typeof foundContext === 'object' ?\n    foundContext.context ?? 'any' :\n    foundContext;\n\n  setDefaults(state);\n\n  incrementSelector(state, contextStr, comment);\n}, {\n  contextSelected: true,\n  exit ({\n    context,\n    state,\n  }) {\n    if (!context.options.length) {\n      context.report({\n        loc: {\n          start: {\n            column: 1,\n            line: 1,\n          },\n        },\n        message: 'Rule `no-missing-syntax` is missing a `context` option.',\n      });\n\n      return;\n    }\n\n    setDefaults(state);\n\n    const {\n      contexts,\n    } = context.options[0];\n\n    // Report when MISSING\n    contexts.some((cntxt) => {\n      const contextStr = typeof cntxt === 'object' ? cntxt.context ?? 'any' : cntxt;\n      const comment = cntxt?.comment ?? '';\n\n      const contextKey = contextStr === 'any' ? undefined : contextStr;\n\n      if (\n        (!state.selectorMap[contextKey] ||\n        !state.selectorMap[contextKey][comment] ||\n        state.selectorMap[contextKey][comment] < (cntxt?.minimum ?? 1)) &&\n        (contextStr !== 'any' || Object.values(state.selectorMap).every((cmmnt) => {\n          return !cmmnt[comment] || cmmnt[comment] < (cntxt?.minimum ?? 1);\n        }))\n      ) {\n        const message = cntxt?.message ?? 'Syntax is required: {{context}}' +\n          (comment ? ' with {{comment}}' : '');\n        context.report({\n          data: {\n            comment,\n            context: contextStr,\n          },\n          loc: {\n            end: {\n              line: 1,\n            },\n            start: {\n              line: 1,\n            },\n          },\n          message,\n        });\n\n        return true;\n      }\n\n      return false;\n    });\n  },\n  matchContext: true,\n  meta: {\n    docs: {\n      description: 'Reports when certain comment structures are always expected.',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc#eslint-plugin-jsdoc-rules-no-missing-syntax',\n    },\n    fixable: 'code',\n    schema: [\n      {\n        additionalProperties: false,\n        properties: {\n          contexts: {\n            items: {\n              anyOf: [\n                {\n                  type: 'string',\n                },\n                {\n                  additionalProperties: false,\n                  properties: {\n                    comment: {\n                      type: 'string',\n                    },\n                    context: {\n                      type: 'string',\n                    },\n                    message: {\n                      type: 'string',\n                    },\n                    minimum: {\n                      type: 'integer',\n                    },\n                  },\n                  type: 'object',\n                },\n              ],\n            },\n            type: 'array',\n          },\n        },\n        type: 'object',\n      },\n    ],\n    type: 'suggestion',\n  },\n});\n"],"mappings":"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"}