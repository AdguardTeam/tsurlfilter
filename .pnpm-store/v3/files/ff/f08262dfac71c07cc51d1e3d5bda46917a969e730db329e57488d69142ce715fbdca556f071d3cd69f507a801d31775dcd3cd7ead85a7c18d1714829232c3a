export const types={COMMENT:1,IDENT:2,FUNCTION:3,AT_KEYWORD:4,HASH:5,STRING:6,BAD_STRING:7,URL:8,BAD_URL:9,DELIM:10,NUMBER:11,PERCENTAGE:12,DIMENSION:13,WHITESPACE:14,CDO:15,CDC:16,COLON:17,SEMICOLON:18,COMMA:19,LEFT_SQUARE:20,RIGHT_SQUARE:21,LEFT_PAREN:22,RIGHT_PAREN:23,LEFT_CURLY:24,RIGHT_CURLY:25};let e=e=>(48^e)<=9||(32|e)>=97&&(32|e)<=102,t=e=>(32|e)>=97&&(32|e)<=122||95===e||8204===e||8205===e||8255===e||8256===e||183===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536,r=e=>45===e||(48^e)<=9||t(e),n=e=>10===e||12===e||13===e,o=e=>n(e)||32===e||9===e,i=e=>34===e||39===e,c=e=>e>=0&&e<=8||11===e||e>=14&&e<=31||127==e,l={40:22,41:23,44:19,58:17,59:18,91:20,93:21,123:24,125:25},a=[];for(let e=0;e<128;e+=1)a[e]=c(e)&&1||o(e)&&2||i(e)&&3||(48^e)<=9&&4||l[e]&&5||(43===e||45===e)&&6||t(e)&&7||e;let s=(e,t)=>{let r=e.codePointAt(t);return a[r]||r},u=(e,t)=>92===e.codePointAt(t)&&!n(e.codePointAt(t+1)),d=(e,t)=>{let r=s(e,t),n=s(e,t+1);return 4===r||6===r&&4===n||6===r&&46===n&&4===s(e,t+2)||46===r&&4===n},A=(e,r)=>{45===e.codePointAt(r)&&(r+=1);let n=e.codePointAt(r);return 45===n||t(n)||u(e,r)},f=(e,t,r)=>{for(;s(e,t)===r;)t+=1;return t},P=(t,r)=>{if((r+=2)>t.length)return t.length;if(e(t.codePointAt(r-1))){for(let n=0;e(t.codePointAt(r))&&n<5;n+=1,r+=1);2===s(t,r)&&(r+=1)}return r},b=t=>{if(!e(t.codePointAt(0)))return t[0]||"�";let r=parseInt(t,16)||0;return r>1114111||r<=0||r>=55296&&r<=57343?"�":String.fromCodePoint(r)},k=(e,t)=>{let n=e.length;for(;t<n;){let n=e.codePointAt(t);if(r(n))t+=1+ +(n>65535);else if(u(e,t))t=P(e,t);else break}return t},E=e=>{let t="";for(let n=0;n<e.length;){let o=e.codePointAt(n);if(r(o))t+=String.fromCodePoint(o),n+=1+ +(o>65535);else if(u(e,n))t+=b(e.slice(n+1,n=P(e,n)));else break}return t},C=(e,t)=>{let r=s(e,t);return 6===r&&(t+=1),t=f(e,t,4),46===s(e,t)&&4===s(e,t+1)&&(t=f(e,t+2,4)),r=s(e,t+1),(32|e.codePointAt(t))==101&&(4===r||6===r&&4===s(e,t+2))&&(t=f(e,t+2,4)),t},R=(e,t)=>{let r=8,n=e.length;for(t=f(e,t,2);t<n;){let n=e.codePointAt(t),o=s(e,t);if(41===n){t+=1;break}if(8===r&&(3===o||40===n||1===o))r=9;else if(92===n)u(e,t)?t=P(e,t):(t+=1,r=9);else if(2===o){if(t=f(e,t,2),n=e.codePointAt(t)){if(41===n){t+=1;break}r=9}else break}else t+=1}return[r,t]},h=(e,t)=>{let r=t;if(t=k(e,t),40===e.codePointAt(t)){let n=f(e,t+1,2);return n-(t+=1)<=4&&"url"==E(e.slice(r,t-1)).toLowerCase()&&3!==s(e,n)?R(e,t):[3,t]}return[2,t]},N=(e,t)=>{t=C(e,t);let r=11;return 37===e.codePointAt(t)?(t+=1,r=12):A(e,t)&&(t=k(e,t),r=13),[r,t]},T=(e,t)=>{let r=e.codePointAt(t);t+=1;let o=e.length;for(;t<o;)switch(e.codePointAt(t)){case r:return[6,t+=1];case 10:case 12:case 13:return[7,t];case 92:t==o-1?t+=1:n(e.codePointAt(t+1))?t+=2:u(e,t)&&(t=P(e,t));break;default:t+=1}return[6,t]};export function*lex(e){let t;let n=e.length,o=0,i=0;for(;i<n;){switch(s(e,i)){case 2:i=f(e,i,2),t=14;break;case 3:[t,i]=T(e,i);break;case 4:[t,i]=N(e,i);break;case 6:d(e,i)?[t,i]=N(e,i):45===e.codePointAt(i)&&45===e.codePointAt(i+1)&&62===e.codePointAt(i+2)?(t=16,i+=3):45===e.codePointAt(i)&&A(e,i)?[t,i]=h(e,i):(t=10,i+=1);break;case 46:d(e,i)?[t,i]=N(e,i):(t=10,i+=1);break;case 7:[t,i]=h(e,i);break;case 60:33===e.codePointAt(i+1)&&45===e.codePointAt(i+2)&&45===e.codePointAt(i+3)?(t=15,i+=4):(t=10,i+=1);break;case 35:r(e.codePointAt(i+1))||u(e,i+1)?(i=k(e,i+1),t=5):(t=10,i+=1);break;case 64:A(e,i+1)?(i=k(e,i+1),t=4):(t=10,i+=1);break;case 92:u(e,i)?[t,i]=h(e,i):(t=10,i+=1);break;case 47:42===e.codePointAt(i+1)?(-1===(i=e.indexOf("*/",i+2))&&(i=n),t=1,i=i===n?i:i+2):(t=10,i+=1);break;case 5:t=l[e.codePointAt(i)],i+=1;break;default:A(e,i)?[t,i]=h(e,i):(t=10,i+=1)}yield[t,o,o=i]}}export const value=(e,[t,r,l])=>{switch(t){case 1:return e.slice(r+2,l-2);case 6:{let t=e.codePointAt(r),o="";for(let i=r+1;i<l;i+=1)switch(e.codePointAt(i)){case t:return o;case 92:if(i+1===l&&l===e.length)return o;if(n(e.codePointAt(i+1))){i+=1;break}if(u(e,i)){o+=b(e.slice(i+1,i=P(e,i))),i-=1;break}default:o+=e[i]}return o}case 10:return e[r];case 12:case 13:case 11:{let n=C(e,r),o=e.slice(r,n),i={value:parseFloat(o)||0,type:o.includes(".")||o.includes("E")||o.includes("e")?"number":"integer"};return 6===s(o,0)&&(i.signCharacter=o[0]),13===t&&(i.unit=E(e.slice(n,l))),i}case 5:{let t=A(e,r+1)?"id":"unrestricted",n=E(e.slice(r+1,l));return{type:t,value:n}}case 4:r+=1;case 3:case 2:return E(e.slice(r,l));case 8:{let t="",n=k(e,r)+1;for(n=f(e,n,2);n<e.length;){let r=e[n];if(")"===r){n+=1;break}if(i(e.codePointAt(n))||"("===r||c(e.codePointAt(n)))return null;if("\\"===r){if(!u(e,n))return null;r=b(e.slice(n+1,n=P(e,n)))}else if(o(e.codePointAt(n))){if(n=f(e,n,2),!(r=e[n]))break;if(")"!==r)return null;n+=1;break}else n+=1;t+=r}return t}default:return null}};
